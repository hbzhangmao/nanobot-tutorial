<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NanoBot ğŸˆ å®ç°åŸç†æ·±åº¦è§£æ</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0f1117;--bg2:#161822;--bg3:#1e2030;--text:#c8cad8;--text2:#8890a4;--accent:#60a5fa;--green:#34d399;--orange:#fb923c;--pink:#f472b6;--purple:#a78bfa;--red:#f87171;--yellow:#fbbf24;--border:#2a2d3e}
html{scroll-behavior:smooth}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:var(--bg);color:var(--text);line-height:1.7;font-size:16px}
a{color:var(--accent);text-decoration:none}
a:hover{text-decoration:underline}

/* ä¾§è¾¹å¯¼èˆª */
.sidebar{position:fixed;left:0;top:0;width:260px;height:100vh;background:var(--bg2);border-right:1px solid var(--border);overflow-y:auto;padding:20px 0;z-index:100}
.sidebar .logo{padding:0 20px 20px;font-size:22px;font-weight:700;color:#fff;border-bottom:1px solid var(--border)}
.sidebar .logo span{color:var(--accent)}
.sidebar nav{padding:15px 0}
.sidebar nav a{display:block;padding:8px 20px;color:var(--text2);font-size:14px;transition:all .2s}
.sidebar nav a:hover,.sidebar nav a.active{color:var(--accent);background:rgba(96,165,250,.08);text-decoration:none}
.sidebar nav a.sub{padding-left:36px;font-size:13px}

/* ä¸»å†…å®¹ */
.main{margin-left:260px;padding:40px 50px;max-width:960px}
.main h1{font-size:32px;color:#fff;margin-bottom:8px}
.main .subtitle{color:var(--text2);margin-bottom:40px;font-size:15px}
.main h2{font-size:24px;color:#fff;margin:50px 0 20px;padding-bottom:10px;border-bottom:1px solid var(--border)}
.main h3{font-size:18px;color:var(--accent);margin:30px 0 15px}
.main p{margin-bottom:14px}
.main ul,.main ol{margin:0 0 14px 20px}
.main li{margin-bottom:6px}

/* ä»£ç å— */
.code-block{position:relative;background:var(--bg3);border:1px solid var(--border);border-radius:10px;margin:14px 0 20px;overflow:hidden}
.code-block pre{margin:0;padding:18px 20px;overflow-x:auto;font-family:'Fira Code','JetBrains Mono',Consolas,'Courier New',monospace;font-size:13.5px;line-height:1.75;white-space:pre;color:var(--text);-webkit-overflow-scrolling:touch}
.code-block .kw{color:var(--purple)}
.code-block .fn{color:var(--accent)}
.code-block .str{color:var(--green)}
.code-block .cmt{color:#6a7080;font-style:italic}
.code-block .cls{color:var(--yellow)}
.code-block .op{color:var(--pink)}
.code-block .num{color:var(--orange)}
.code-block .dec{color:var(--pink)}
.code-header{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;background:rgba(255,255,255,.03);border-bottom:1px solid var(--border);font-size:12px;color:var(--text2)}
.code-header .lang{font-weight:600;text-transform:uppercase;letter-spacing:.5px}
.copy-btn{background:none;border:1px solid var(--border);border-radius:6px;color:var(--text2);padding:3px 10px;font-size:11px;cursor:pointer;transition:all .2s}
.copy-btn:hover{color:var(--accent);border-color:var(--accent)}
.copy-btn.copied{color:var(--green);border-color:var(--green)}
.code-header .file-path{color:var(--text2);font-size:11px;margin-left:8px;font-style:italic}
code{background:rgba(96,165,250,.1);color:var(--accent);padding:2px 7px;border-radius:4px;font-family:'Fira Code','JetBrains Mono',Consolas,monospace;font-size:0.88em}

/* æ ‡ç­¾ */
.tag{display:inline-block;padding:2px 10px;border-radius:12px;font-size:12px;font-weight:600;margin:2px 4px 2px 0}
.tag-blue{background:rgba(96,165,250,.15);color:var(--accent)}
.tag-green{background:rgba(52,211,153,.15);color:var(--green)}
.tag-orange{background:rgba(251,146,60,.15);color:var(--orange)}
.tag-pink{background:rgba(244,114,182,.15);color:var(--pink)}
.tag-purple{background:rgba(167,139,250,.15);color:var(--purple)}

/* è¡¨æ ¼ */
table{width:100%;border-collapse:collapse;margin:14px 0 20px;font-size:14px}
th{background:var(--bg3);color:var(--accent);text-align:left;padding:10px 14px;border:1px solid var(--border)}
td{padding:10px 14px;border:1px solid var(--border)}
tr:hover td{background:rgba(96,165,250,.04)}

/* æ¶æ„å›¾ */
.arch-diagram{background:var(--bg2);border:1px solid var(--border);border-radius:12px;padding:30px 20px;margin:20px 0 30px;overflow-x:auto}
.arch-row{display:flex;align-items:center;justify-content:center;gap:8px;flex-wrap:wrap;margin:10px 0}
.arch-box{padding:10px 18px;border-radius:8px;font-size:13px;font-weight:600;text-align:center;white-space:nowrap;min-width:80px}
.arch-box.user{background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff}
.arch-box.channel{background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:#fff}
.arch-box.bus{background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff}
.arch-box.agent{background:linear-gradient(135deg,#10b981,#059669);color:#fff;padding:14px 24px;font-size:15px}
.arch-box.llm{background:linear-gradient(135deg,#ec4899,#db2777);color:#fff}
.arch-box.tool{background:linear-gradient(135deg,#06b6d4,#0891b2);color:#fff}
.arch-box.memory{background:linear-gradient(135deg,#f97316,#ea580c);color:#fff}
.arch-box.skill{background:linear-gradient(135deg,#a855f7,#9333ea);color:#fff}
.arch-arrow{color:var(--text2);font-size:20px;font-weight:700}
.arch-arrow-down{text-align:center;color:var(--text2);font-size:20px;margin:4px 0}
.arch-label{font-size:11px;color:var(--text2);text-align:center;margin-top:2px}
.arch-group{display:flex;flex-direction:column;align-items:center;gap:4px}
.arch-channels{display:flex;gap:6px;flex-wrap:wrap;justify-content:center}
.arch-channels .mini{padding:5px 10px;border-radius:6px;font-size:11px;background:rgba(139,92,246,.2);color:var(--purple);border:1px solid rgba(139,92,246,.3)}

/* æµç¨‹å›¾ */
.flow{display:flex;flex-direction:column;gap:0;margin:20px 0}
.flow-step{display:flex;align-items:flex-start;gap:14px;padding:12px 0}
.flow-num{width:32px;height:32px;border-radius:50%;background:var(--accent);color:#fff;display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:700;flex-shrink:0}
.flow-content{flex:1}
.flow-content strong{color:#fff}
.flow-line{width:32px;display:flex;justify-content:center}
.flow-line::after{content:'';display:block;width:2px;height:20px;background:var(--border)}

/* å¡ç‰‡ */
.card{background:var(--bg2);border:1px solid var(--border);border-radius:10px;padding:20px;margin:14px 0}
.card-title{color:#fff;font-weight:700;margin-bottom:8px}

/* æ ‘å½¢ç»“æ„ */
.tree{position:relative;background:var(--bg3);border:1px solid var(--border);border-radius:10px;margin:14px 0;overflow:hidden}
.tree .tree-header{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;background:rgba(255,255,255,.03);border-bottom:1px solid var(--border);font-size:12px;color:var(--text2)}
.tree .tree-header .lang{font-weight:600;letter-spacing:.5px}
.tree pre{margin:0;padding:18px 20px;overflow-x:auto;font-family:'Fira Code','JetBrains Mono',Consolas,'Courier New',monospace;font-size:13px;line-height:1.85;white-space:pre;color:var(--text);-webkit-overflow-scrolling:touch}
.tree .dir{color:var(--yellow);font-weight:600}
.tree .file{color:var(--text)}
.tree .desc{color:#6a7080;font-style:italic}
.tree .connector{color:var(--border)}

/* æ‰‹æœºèœå•æŒ‰é’® */
.menu-btn{display:none;position:fixed;top:12px;left:12px;z-index:200;width:40px;height:40px;border-radius:8px;background:var(--bg2);border:1px solid var(--border);color:#fff;font-size:20px;cursor:pointer;align-items:center;justify-content:center}

/* å“åº”å¼ */
@media(max-width:768px){
  .sidebar{transform:translateX(-100%);transition:transform .3s;width:280px}
  .sidebar.open{transform:translateX(0)}
  .main{margin-left:0;padding:20px 16px;padding-top:60px}
  .menu-btn{display:flex}
  .arch-row{gap:4px}
  .arch-box{padding:7px 12px;font-size:11px;min-width:60px}
  .main h1{font-size:24px}
  .main h2{font-size:20px}
}
.overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:99}
.overlay.show{display:block}

/* é¡µè„š */
footer{margin-top:60px;padding:20px 0;border-top:1px solid var(--border);color:var(--text2);font-size:13px;text-align:center}
</style>
</head>
<body>

<button class="menu-btn" onclick="toggleMenu()">â˜°</button>
<div class="overlay" onclick="toggleMenu()"></div>

<aside class="sidebar">
  <div class="logo">ğŸˆ <span>NanoBot</span> åŸç†è§£æ</div>
  <nav>
    <a href="#overview">æ¶æ„æ€»è§ˆ</a>
    <a href="#bus" class="sub">æ¶ˆæ¯æ€»çº¿</a>
    <a href="#agent-loop" class="sub">Agent å¾ªç¯</a>
    <a href="#context" class="sub">ä¸Šä¸‹æ–‡æ„å»º</a>
    <a href="#llm" class="sub">LLM Provider</a>
    <a href="#channels" class="sub">æ¸ é“ç³»ç»Ÿ</a>
    <a href="#tools" class="sub">å·¥å…·ç³»ç»Ÿ</a>
    <a href="#skills" class="sub">æŠ€èƒ½ç³»ç»Ÿ</a>
    <a href="#memory" class="sub">è®°å¿†ç³»ç»Ÿ</a>
    <a href="#session" class="sub">ä¼šè¯ç®¡ç†</a>
    <a href="#subagent" class="sub">å­ä»£ç†</a>
    <a href="#cron" class="sub">å®šæ—¶ä»»åŠ¡</a>
    <a href="#heartbeat" class="sub">å¿ƒè·³æœåŠ¡</a>
    <a href="#config">é…ç½®ç³»ç»Ÿ</a>
    <a href="#structure">é¡¹ç›®ç»“æ„</a>
    <a href="#tech">æŠ€æœ¯æ ˆ</a>
  </nav>
</aside>

<main class="main">
<h1>NanoBot ğŸˆ å®ç°åŸç†æ·±åº¦è§£æ</h1>
<p class="subtitle">åŸºäº HKUDS/nanobot é¡¹ç›®æºç åˆ†æ Â· ç‰ˆæœ¬ 0.1.3 Â· è½»é‡çº§ä¸ªäºº AI åŠ©æ‰‹æ¡†æ¶</p>

<!-- æ¶æ„æ€»è§ˆ -->
<h2 id="overview">æ¶æ„æ€»è§ˆ</h2>
<p>NanoBot é‡‡ç”¨<strong>æ¶ˆæ¯æ€»çº¿ + Agent å¾ªç¯</strong>çš„æ¶æ„ï¼Œå°†æ¸ é“æ¥å…¥ã€LLM æ¨ç†ã€å·¥å…·æ‰§è¡Œä¸‰è€…è§£è€¦ã€‚æ ¸å¿ƒæ•°æ®æµå¦‚ä¸‹ï¼š</p>

<div class="arch-diagram">
  <div class="arch-row">
    <div class="arch-group">
      <div class="arch-box user">ğŸ‘¤ ç”¨æˆ·</div>
    </div>
    <div class="arch-arrow">âŸ¶</div>
    <div class="arch-group">
      <div class="arch-box channel">ğŸ“¡ æ¸ é“å±‚</div>
      <div class="arch-channels">
        <span class="mini">Telegram</span>
        <span class="mini">é£ä¹¦</span>
        <span class="mini">é’‰é’‰</span>
        <span class="mini">Discord</span>
        <span class="mini">Slack</span>
        <span class="mini">QQ</span>
        <span class="mini">WhatsApp</span>
        <span class="mini">Email</span>
      </div>
    </div>
    <div class="arch-arrow">âŸ¶</div>
    <div class="arch-group">
      <div class="arch-box bus">ğŸšŒ æ¶ˆæ¯æ€»çº¿</div>
      <div class="arch-label">MessageBus</div>
    </div>
    <div class="arch-arrow">âŸ¶</div>
    <div class="arch-group">
      <div class="arch-box agent">ğŸ§  AgentLoop</div>
      <div class="arch-label">æ ¸å¿ƒå¼•æ“</div>
    </div>
  </div>
  <div class="arch-arrow-down">âŸ·</div>
  <div class="arch-row">
    <div class="arch-group">
      <div class="arch-box llm">ğŸ¤– LLM Provider</div>
      <div class="arch-label">LiteLLM ç»Ÿä¸€æ¥å£</div>
    </div>
    <div style="width:30px"></div>
    <div class="arch-group">
      <div class="arch-box tool">ğŸ”§ å·¥å…·ç³»ç»Ÿ</div>
      <div class="arch-label">10 ä¸ªå†…ç½®å·¥å…·</div>
    </div>
    <div style="width:30px"></div>
    <div class="arch-group">
      <div class="arch-box skill">âš¡ æŠ€èƒ½ç³»ç»Ÿ</div>
      <div class="arch-label">æ¸è¿›å¼åŠ è½½</div>
    </div>
    <div style="width:30px"></div>
    <div class="arch-group">
      <div class="arch-box memory">ğŸ’¾ è®°å¿†ç³»ç»Ÿ</div>
      <div class="arch-label">ä¸¤å±‚è®°å¿†</div>
    </div>
  </div>
</div>

<p>æ•´ä¸ªç³»ç»Ÿçš„è¿è¡Œæµç¨‹ï¼šç”¨æˆ·é€šè¿‡ä»»æ„æ¸ é“å‘é€æ¶ˆæ¯ â†’ æ¸ é“å°†æ¶ˆæ¯å°è£…ä¸º <code>InboundMessage</code> æŠ•é€’åˆ°æ¶ˆæ¯æ€»çº¿ â†’ AgentLoop å–å‡ºæ¶ˆæ¯ï¼Œæ„å»ºä¸Šä¸‹æ–‡ï¼Œè°ƒç”¨ LLM â†’ LLM å¯èƒ½è¿”å›å·¥å…·è°ƒç”¨è¯·æ±‚ â†’ æ‰§è¡Œå·¥å…·å¹¶å°†ç»“æœåé¦ˆç»™ LLM â†’ å¾ªç¯ç›´åˆ° LLM è¿”å›æœ€ç»ˆæ–‡æœ¬å“åº” â†’ é€šè¿‡æ¶ˆæ¯æ€»çº¿å’Œæ¸ é“å›å¤ç”¨æˆ·ã€‚</p>

<!-- æ¶ˆæ¯æ€»çº¿ -->
<h2 id="bus">æ ¸å¿ƒæ¨¡å—è§£æ</h2>
<h3>2.1 æ¶ˆæ¯æ€»çº¿ (MessageBus)</h3>
<p>æ¶ˆæ¯æ€»çº¿æ˜¯æ•´ä¸ªç³»ç»Ÿçš„é€šä¿¡ä¸­æ¢ï¼Œé‡‡ç”¨å¼‚æ­¥é˜Ÿåˆ—è®¾è®¡ï¼Œå½»åº•è§£è€¦æ¸ é“å±‚å’Œ Agent å±‚ã€‚</p>
<div class="card">
  <div class="card-title">æ ¸å¿ƒè®¾è®¡</div>
  <ul>
    <li><strong>InboundMessage</strong>ï¼šå°è£…ç”¨æˆ·è¾“å…¥ï¼ŒåŒ…å« channelã€chat_idã€textã€attachments ç­‰å­—æ®µ</li>
    <li><strong>OutboundMessage</strong>ï¼šå°è£… Agent å“åº”ï¼ŒåŒ…å«ç›®æ ‡ channelã€chat_idã€text</li>
    <li>åŸºäº Python <code>asyncio.Queue</code> å®ç°ï¼Œå¤©ç„¶æ”¯æŒå¹¶å‘</li>
    <li>æŒ‰ <code>channel:chat_id</code> è·¯ç”±æ¶ˆæ¯ï¼Œç¡®ä¿ä¸åŒç”¨æˆ·/æ¸ é“çš„æ¶ˆæ¯äº’ä¸å¹²æ‰°</li>
  </ul>
</div>
<div class="code-block">
<div class="code-header"><span class="lang">Python</span><span class="file-path">bus/events.py</span><button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶</button></div>
<pre><span class="dec">@dataclass</span>
<span class="kw">class</span> <span class="cls">InboundMessage</span>:
    channel: <span class="cls">str</span>          <span class="cmt"># "telegram", "feishu", ...</span>
    chat_id: <span class="cls">str</span>          <span class="cmt"># ç”¨æˆ·/ç¾¤ç»„æ ‡è¯†</span>
    text: <span class="cls">str</span>             <span class="cmt"># æ¶ˆæ¯æ–‡æœ¬</span>
    attachments: <span class="cls">list</span>     <span class="cmt"># å›¾ç‰‡ã€æ–‡ä»¶ç­‰é™„ä»¶</span>
    metadata: <span class="cls">dict</span>        <span class="cmt"># é¢å¤–å…ƒæ•°æ®</span>

<span class="dec">@dataclass</span>
<span class="kw">class</span> <span class="cls">OutboundMessage</span>:
    channel: <span class="cls">str</span>
    chat_id: <span class="cls">str</span>
    text: <span class="cls">str</span></pre>
</div>

<!-- Agent å¾ªç¯ -->
<h3 id="agent-loop">2.2 Agent å¾ªç¯ (AgentLoop)</h3>
<p>AgentLoop æ˜¯ NanoBot çš„æ ¸å¿ƒå¼•æ“ï¼Œå®ç°äº†ç»å…¸çš„ <strong>ReActï¼ˆReasoning + Actingï¼‰</strong>æ¨¡å¼ã€‚æ¯æ¡ç”¨æˆ·æ¶ˆæ¯éƒ½ä¼šè§¦å‘ä¸€ä¸ªå¤„ç†å¾ªç¯ã€‚</p>

<div class="flow">
  <div class="flow-step"><div class="flow-num">1</div><div class="flow-content"><strong>æ¥æ”¶æ¶ˆæ¯</strong> â€” ä»æ¶ˆæ¯æ€»çº¿å–å‡º InboundMessage</div></div>
  <div class="flow-line"></div>
  <div class="flow-step"><div class="flow-num">2</div><div class="flow-content"><strong>åŠ è½½ä¼šè¯</strong> â€” SessionManager æŒ‰ channel:chat_id æŸ¥æ‰¾/åˆ›å»ºä¼šè¯ï¼ŒåŠ è½½å†å²æ¶ˆæ¯</div></div>
  <div class="flow-line"></div>
  <div class="flow-step"><div class="flow-num">3</div><div class="flow-content"><strong>æ„å»ºä¸Šä¸‹æ–‡</strong> â€” ContextBuilder ç»„è£… system promptï¼ˆèº«ä»½ + è®°å¿† + æŠ€èƒ½ + Bootstrap æ–‡ä»¶ï¼‰</div></div>
  <div class="flow-line"></div>
  <div class="flow-step"><div class="flow-num">4</div><div class="flow-content"><strong>è°ƒç”¨ LLM</strong> â€” é€šè¿‡ LiteLLMProvider å‘é€æ¶ˆæ¯åˆ—è¡¨ï¼Œè·å– LLM å“åº”</div></div>
  <div class="flow-line"></div>
  <div class="flow-step"><div class="flow-num">5</div><div class="flow-content"><strong>è§£æå“åº”</strong> â€” å¦‚æœ LLM è¿”å› tool_callsï¼Œè¿›å…¥å·¥å…·æ‰§è¡Œï¼›å¦åˆ™è¿”å›æ–‡æœ¬å“åº”</div></div>
  <div class="flow-line"></div>
  <div class="flow-step"><div class="flow-num">6</div><div class="flow-content"><strong>æ‰§è¡Œå·¥å…·</strong> â€” ToolRegistry æŸ¥æ‰¾å¹¶æ‰§è¡Œå·¥å…·ï¼Œå°†ç»“æœè¿½åŠ åˆ°æ¶ˆæ¯å†å²</div></div>
  <div class="flow-line"></div>
  <div class="flow-step"><div class="flow-num">7</div><div class="flow-content"><strong>å¾ªç¯è¿­ä»£</strong> â€” å›åˆ°æ­¥éª¤ 4ï¼Œç›´åˆ° LLM è¿”å›çº¯æ–‡æœ¬æˆ–è¾¾åˆ° max_iterationsï¼ˆé»˜è®¤ 20ï¼‰</div></div>
  <div class="flow-line"></div>
  <div class="flow-step"><div class="flow-num">8</div><div class="flow-content"><strong>å‘é€å“åº”</strong> â€” å°†æœ€ç»ˆæ–‡æœ¬å°è£…ä¸º OutboundMessage æŠ•é€’åˆ°æ¶ˆæ¯æ€»çº¿</div></div>
</div>

<div class="code-block">
<div class="code-header"><span class="lang">Python</span><span class="file-path">agent/loop.py â€” æ ¸å¿ƒå¾ªç¯ç®€åŒ–ç‰ˆ</span><button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶</button></div>
<pre><span class="kw">async def</span> <span class="fn">_process_message</span>(self, msg: InboundMessage):
    session = self.session_mgr.<span class="fn">get_or_create</span>(msg.channel, msg.chat_id)
    session.<span class="fn">append</span>({<span class="str">"role"</span>: <span class="str">"user"</span>, <span class="str">"content"</span>: msg.text})

    <span class="kw">for</span> i <span class="kw">in</span> <span class="fn">range</span>(self.max_iterations):
        context = self.context_builder.<span class="fn">build</span>(session)
        response = <span class="kw">await</span> self.provider.<span class="fn">chat</span>(context)

        <span class="kw">if</span> response.tool_calls:
            <span class="kw">for</span> tc <span class="kw">in</span> response.tool_calls:
                result = <span class="kw">await</span> self.tools.<span class="fn">execute</span>(tc.name, tc.args)
                session.<span class="fn">append</span>({<span class="str">"role"</span>: <span class="str">"tool"</span>, <span class="str">"content"</span>: result})
        <span class="kw">else</span>:
            <span class="kw">return</span> response.text  <span class="cmt"># æœ€ç»ˆå“åº”</span></pre>
</div>

<!-- ä¸Šä¸‹æ–‡æ„å»º -->
<h3 id="context">2.3 ä¸Šä¸‹æ–‡æ„å»º (ContextBuilder)</h3>
<p>ContextBuilder è´Ÿè´£ç»„è£…å‘é€ç»™ LLM çš„ system promptï¼Œè¿™æ˜¯ NanoBot "äººæ ¼"å’Œ"èƒ½åŠ›"çš„æ ¸å¿ƒã€‚</p>
<div class="card">
  <div class="card-title">System Prompt ç»„è£…é¡ºåº</div>
  <ol>
    <li><span class="tag tag-blue">Identity</span> èº«ä»½å®šä¹‰ â€” IDENTITY.md æˆ–å†…ç½®é»˜è®¤èº«ä»½</li>
    <li><span class="tag tag-green">Bootstrap</span> å¼•å¯¼æ–‡ä»¶ â€” AGENTS.md, SOUL.md, USER.md, TOOLS.md</li>
    <li><span class="tag tag-orange">Memory</span> é•¿æœŸè®°å¿† â€” MEMORY.md çš„å®Œæ•´å†…å®¹</li>
    <li><span class="tag tag-purple">Skills</span> æŠ€èƒ½å…ƒæ•°æ® â€” æ‰€æœ‰å¯ç”¨æŠ€èƒ½çš„ name + description</li>
    <li><span class="tag tag-pink">Active Skills</span> å·²æ¿€æ´»æŠ€èƒ½ â€” è¢«è§¦å‘çš„æŠ€èƒ½çš„ SKILL.md å®Œæ•´å†…å®¹</li>
  </ol>
</div>
<p>Bootstrap æ–‡ä»¶æ˜¯å¯é€‰çš„è‡ªå®šä¹‰æ–‡ä»¶ï¼Œæ”¾åœ¨ workspace æ ¹ç›®å½•ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡è¿™äº›æ–‡ä»¶å®šåˆ¶ Agent çš„è¡Œä¸ºã€äººæ ¼å’Œå·¥å…·ä½¿ç”¨åå¥½ï¼Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚</p>

<!-- LLM Provider -->
<h3 id="llm">2.4 LLM Provider å±‚</h3>
<p>NanoBot é€šè¿‡ <strong>LiteLLM</strong> å®ç°äº†ç»Ÿä¸€çš„ LLM è°ƒç”¨æ¥å£ï¼Œæ”¯æŒ 11 ä¸ª Providerï¼Œä¸€å¥—ä»£ç å¯¹æ¥æ‰€æœ‰ä¸»æµå¤§æ¨¡å‹ã€‚</p>

<table>
  <tr><th>Provider</th><th>åŒ¹é…å…³é”®è¯</th><th>ç±»å‹</th></tr>
  <tr><td>Anthropic</td><td>anthropic, claude</td><td><span class="tag tag-green">æ ‡å‡†</span></td></tr>
  <tr><td>OpenAI</td><td>openai, gpt</td><td><span class="tag tag-green">æ ‡å‡†</span></td></tr>
  <tr><td>DeepSeek</td><td>deepseek</td><td><span class="tag tag-green">æ ‡å‡†</span></td></tr>
  <tr><td>Gemini</td><td>gemini</td><td><span class="tag tag-green">æ ‡å‡†</span></td></tr>
  <tr><td>é€šä¹‰åƒé—®</td><td>qwen, dashscope</td><td><span class="tag tag-green">æ ‡å‡†</span></td></tr>
  <tr><td>æ™ºè°± AI</td><td>zhipu, glm</td><td><span class="tag tag-green">æ ‡å‡†</span></td></tr>
  <tr><td>Moonshot</td><td>moonshot, kimi</td><td><span class="tag tag-green">æ ‡å‡†</span></td></tr>
  <tr><td>MiniMax</td><td>minimax</td><td><span class="tag tag-green">æ ‡å‡†</span></td></tr>
  <tr><td>OpenRouter</td><td>openrouter</td><td><span class="tag tag-blue">ç½‘å…³</span></td></tr>
  <tr><td>AiHubMix</td><td>aihubmix</td><td><span class="tag tag-blue">ç½‘å…³</span></td></tr>
  <tr><td>vLLM</td><td>vllm</td><td><span class="tag tag-orange">æœ¬åœ°</span></td></tr>
</table>

<div class="card">
  <div class="card-title">Provider è‡ªåŠ¨åŒ¹é…æœºåˆ¶</div>
  <p>é…ç½®ä¸­åªéœ€æŒ‡å®šæ¨¡å‹åï¼ˆå¦‚ <code>anthropic/claude-opus-4-5</code>ï¼‰ï¼Œç³»ç»Ÿä¼šæ ¹æ®æ¨¡å‹åä¸­çš„å…³é”®è¯è‡ªåŠ¨åŒ¹é…å¯¹åº”çš„ Providerï¼Œæ‹¼æ¥æ­£ç¡®çš„ LiteLLM å‰ç¼€ï¼Œå¹¶æ³¨å…¥ api_keyã€api_base ç­‰é…ç½®ã€‚</p>
</div>

<!-- æ¸ é“ç³»ç»Ÿ -->
<h3 id="channels">2.5 æ¸ é“ç³»ç»Ÿ (Channels)</h3>
<p>æ¸ é“ç³»ç»Ÿé‡‡ç”¨<strong>ç­–ç•¥æ¨¡å¼</strong>ï¼Œæ‰€æœ‰æ¸ é“å®ç°ç»Ÿä¸€çš„ BaseChannel æ¥å£ï¼Œç”± ChannelManager ç»Ÿä¸€ç®¡ç†ç”Ÿå‘½å‘¨æœŸã€‚</p>

<div class="code-block">
<div class="code-header"><span class="lang">Python</span><span class="file-path">channels/base.py</span><button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶</button></div>
<pre><span class="kw">class</span> <span class="cls">BaseChannel</span>(ABC):
    <span class="kw">async def</span> <span class="fn">start</span>(self): ...    <span class="cmt"># å¯åŠ¨æ¸ é“ï¼ˆå»ºç«‹è¿æ¥ï¼‰</span>
    <span class="kw">async def</span> <span class="fn">stop</span>(self): ...     <span class="cmt"># åœæ­¢æ¸ é“</span>
    <span class="kw">async def</span> <span class="fn">send</span>(self, msg): ... <span class="cmt"># å‘é€æ¶ˆæ¯ç»™ç”¨æˆ·</span></pre>
</div>

<table>
  <tr><th>æ¸ é“</th><th>åè®®</th><th>ç‰¹ç‚¹</th></tr>
  <tr><td>Telegram</td><td>Bot API (é•¿è½®è¯¢)</td><td>æœ€æˆç†Ÿï¼Œæ”¯æŒ proxy</td></tr>
  <tr><td>é£ä¹¦</td><td>WebSocket é•¿è¿æ¥</td><td>ä¼ä¸šçº§ï¼Œæ”¯æŒå›¾ç‰‡è¯†åˆ«</td></tr>
  <tr><td>é’‰é’‰</td><td>Stream Mode</td><td>ä¼ä¸šçº§ï¼Œdingtalk-stream SDK</td></tr>
  <tr><td>Discord</td><td>Gateway WebSocket</td><td>ç¤¾åŒºåœºæ™¯</td></tr>
  <tr><td>Slack</td><td>Socket Mode</td><td>ä¼ä¸šåä½œ</td></tr>
  <tr><td>QQ</td><td>botpy SDK</td><td>å›½å†…ç¤¾äº¤</td></tr>
  <tr><td>WhatsApp</td><td>WebSocket Bridge</td><td>éœ€è¦æ¡¥æ¥æœåŠ¡</td></tr>
  <tr><td>Email</td><td>IMAP + SMTP</td><td>å¼‚æ­¥é€šä¿¡ï¼Œæ”¯æŒ auto_reply</td></tr>
  <tr><td>MoChat</td><td>Socket.IO</td><td>è‡ªå®šä¹‰èŠå¤©</td></tr>
</table>

<p>æ‰€æœ‰æ¸ é“éƒ½æ”¯æŒ <code>allow_from</code> ç™½åå•ï¼Œåªæœ‰æŒ‡å®šç”¨æˆ·/ç¾¤ç»„çš„æ¶ˆæ¯æ‰ä¼šè¢«å¤„ç†ã€‚ChannelManager åœ¨å¯åŠ¨æ—¶æ ¹æ®é…ç½®æ–‡ä»¶ä¸­ <code>enabled: true</code> çš„æ¸ é“é€ä¸€åˆå§‹åŒ–ã€‚</p>

<!-- å·¥å…·ç³»ç»Ÿ -->
<h3 id="tools">2.6 å·¥å…·ç³»ç»Ÿ (Tools)</h3>
<p>å·¥å…·ç³»ç»Ÿè®© LLM èƒ½å¤Ÿä¸å¤–éƒ¨ä¸–ç•Œäº¤äº’ã€‚é‡‡ç”¨<strong>æ³¨å†Œè¡¨æ¨¡å¼</strong>ï¼Œæ‰€æœ‰å·¥å…·ç»§æ‰¿ BaseTool å¹¶æ³¨å†Œåˆ° ToolRegistryã€‚</p>

<table>
  <tr><th>å·¥å…·</th><th>æ¨¡å—</th><th>åŠŸèƒ½</th></tr>
  <tr><td><code>read_file</code></td><td>filesystem.py</td><td>è¯»å–æ–‡ä»¶å†…å®¹</td></tr>
  <tr><td><code>write_file</code></td><td>filesystem.py</td><td>å†™å…¥æ–‡ä»¶ï¼ˆè‡ªåŠ¨åˆ›å»ºç›®å½•ï¼‰</td></tr>
  <tr><td><code>edit_file</code></td><td>filesystem.py</td><td>æŸ¥æ‰¾æ›¿æ¢ç¼–è¾‘æ–‡ä»¶</td></tr>
  <tr><td><code>list_dir</code></td><td>filesystem.py</td><td>åˆ—å‡ºç›®å½•å†…å®¹</td></tr>
  <tr><td><code>exec</code></td><td>shell.py</td><td>æ‰§è¡Œ shell å‘½ä»¤ï¼ˆå¯é…ç½® timeoutï¼‰</td></tr>
  <tr><td><code>web_search</code></td><td>web.py</td><td>ç½‘é¡µæœç´¢ï¼ˆBrave Search APIï¼‰</td></tr>
  <tr><td><code>web_fetch</code></td><td>web.py</td><td>æŠ“å–ç½‘é¡µå†…å®¹å¹¶æå–æ–‡æœ¬</td></tr>
  <tr><td><code>message</code></td><td>message.py</td><td>å‘é€æ¶ˆæ¯åˆ°æŒ‡å®šæ¸ é“</td></tr>
  <tr><td><code>spawn</code></td><td>spawn.py</td><td>åˆ›å»ºåå°å­ä»£ç†</td></tr>
  <tr><td><code>cron</code></td><td>cron.py</td><td>å®šæ—¶ä»»åŠ¡ç®¡ç†</td></tr>
</table>

<div class="card">
  <div class="card-title">å·¥å…·è°ƒç”¨æµç¨‹</div>
  <p>LLM è¿”å› <code>tool_calls</code> æ•°ç»„ â†’ ToolRegistry æ ¹æ®å·¥å…·åæŸ¥æ‰¾å¯¹åº”çš„ Tool å®ä¾‹ â†’ è°ƒç”¨ <code>execute(args)</code> â†’ å°†æ‰§è¡Œç»“æœï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰ä½œä¸º <code>tool</code> è§’è‰²æ¶ˆæ¯è¿½åŠ åˆ°ä¼šè¯ â†’ LLM æ ¹æ®ç»“æœç»§ç»­æ¨ç†ã€‚</p>
  <p><code>restrict_to_workspace</code> é…ç½®å¯é™åˆ¶æ–‡ä»¶æ“ä½œåªèƒ½åœ¨ workspace ç›®å½•å†…è¿›è¡Œï¼Œé˜²æ­¢è¶Šæƒè®¿é—®ã€‚</p>
</div>

<!-- æŠ€èƒ½ç³»ç»Ÿ -->
<h3 id="skills">2.7 æŠ€èƒ½ç³»ç»Ÿ (Skills)</h3>
<p>æŠ€èƒ½ç³»ç»Ÿæ˜¯ NanoBot çš„æ‰©å±•æœºåˆ¶ï¼Œå…è®¸é€šè¿‡å£°æ˜å¼çš„ Markdown æ–‡ä»¶ä¸º Agent æ·»åŠ æ–°èƒ½åŠ›ï¼Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚</p>

<div class="card">
  <div class="card-title">ä¸‰çº§æ¸è¿›å¼åŠ è½½</div>
  <p>æŠ€èƒ½é‡‡ç”¨æŒ‰éœ€åŠ è½½ç­–ç•¥ï¼Œé¿å…ä¸€æ¬¡æ€§å°†æ‰€æœ‰æŠ€èƒ½å†…å®¹å¡å…¥ä¸Šä¸‹æ–‡ï¼ŒèŠ‚çœ tokenï¼š</p>
  <ol>
    <li><span class="tag tag-blue">Level 1 â€” å…ƒæ•°æ®</span> name + descriptionï¼Œå§‹ç»ˆåœ¨ system prompt ä¸­ï¼Œè®© LLM çŸ¥é“æœ‰å“ªäº›æŠ€èƒ½å¯ç”¨</li>
    <li><span class="tag tag-green">Level 2 â€” SKILL.md</span> æŠ€èƒ½è¢«è§¦å‘ååŠ è½½å®Œæ•´è¯´æ˜ï¼ŒåŒ…å«ä½¿ç”¨æ–¹æ³•ã€å‚æ•°ã€ç¤ºä¾‹</li>
    <li><span class="tag tag-orange">Level 3 â€” Resources</span> æŒ‰éœ€åŠ è½½è„šæœ¬ï¼ˆscripts/ï¼‰ã€å‚è€ƒæ–‡æ¡£ï¼ˆreferences/ï¼‰ã€èµ„æºæ–‡ä»¶ï¼ˆassets/ï¼‰</li>
  </ol>
</div>

<div class="code-block">
<div class="code-header"><span class="lang">ç›®å½•ç»“æ„</span><span class="file-path">æŠ€èƒ½ç›®å½•è§„èŒƒ</span></div>
<pre>skills/
â”œâ”€â”€ my-skill/
â”‚   â”œâ”€â”€ SKILL.md          <span class="cmt"># æŠ€èƒ½è¯´æ˜ï¼ˆå¿…é¡»ï¼‰</span>
â”‚   â”œâ”€â”€ scripts/          <span class="cmt"># å¯æ‰§è¡Œè„šæœ¬</span>
â”‚   â”‚   â””â”€â”€ run.py
â”‚   â”œâ”€â”€ references/       <span class="cmt"># å‚è€ƒæ–‡æ¡£</span>
â”‚   â””â”€â”€ assets/           <span class="cmt"># èµ„æºæ–‡ä»¶</span></pre>
</div>

<p>æŠ€èƒ½åˆ†ä¸ºä¸¤ç±»ï¼š<strong>å†…ç½®æŠ€èƒ½</strong>ï¼ˆéš pip åŒ…å®‰è£…ï¼‰å’Œ <strong>workspace è‡ªå®šä¹‰æŠ€èƒ½</strong>ï¼ˆç”¨æˆ·åˆ›å»ºï¼‰ã€‚å½“ä¸¤è€…åŒåæ—¶ï¼Œworkspace æŠ€èƒ½ä¼˜å…ˆã€‚å†…ç½®æŠ€èƒ½åŒ…æ‹¬ï¼š</p>
<ul>
  <li><span class="tag tag-purple">memory</span> ä¸¤å±‚è®°å¿†ç³»ç»Ÿï¼ˆalways=trueï¼Œå§‹ç»ˆåŠ è½½ï¼‰</li>
  <li><span class="tag tag-purple">cron</span> å®šæ—¶ä»»åŠ¡è°ƒåº¦</li>
  <li><span class="tag tag-purple">github</span> GitHub CLI æ“ä½œ</li>
  <li><span class="tag tag-purple">skill-creator</span> åˆ›å»ºæ–°æŠ€èƒ½çš„æŒ‡å—</li>
  <li><span class="tag tag-purple">weather</span> å¤©æ°”æŸ¥è¯¢</li>
  <li><span class="tag tag-purple">summarize</span> å†…å®¹æ‘˜è¦</li>
  <li><span class="tag tag-purple">tmux</span> ç»ˆç«¯ä¼šè¯æ§åˆ¶</li>
</ul>

<!-- è®°å¿†ç³»ç»Ÿ -->
<h3 id="memory">2.8 è®°å¿†ç³»ç»Ÿ (Memory)</h3>
<p>è®°å¿†ç³»ç»Ÿè®© Agent å…·å¤‡è·¨ä¼šè¯çš„æŒä¹…è®°å¿†èƒ½åŠ›ï¼Œé‡‡ç”¨<strong>ä¸¤å±‚è®¾è®¡</strong>ï¼š</p>

<div class="arch-diagram" style="padding:20px">
  <div class="arch-row">
    <div class="arch-group">
      <div class="arch-box memory" style="min-width:200px">ğŸ“‹ MEMORY.md<br><small>é•¿æœŸäº‹å®</small></div>
      <div class="arch-label">å§‹ç»ˆåŠ è½½åˆ° system prompt</div>
      <div class="arch-label">ç”¨æˆ·åå¥½ã€é¡¹ç›®ä¸Šä¸‹æ–‡ã€å…³é”®é…ç½®</div>
    </div>
    <div style="width:40px"></div>
    <div class="arch-group">
      <div class="arch-box tool" style="min-width:200px">ğŸ“œ HISTORY.md<br><small>äº‹ä»¶æ—¥å¿—</small></div>
      <div class="arch-label">Append-onlyï¼Œä¸åŠ è½½åˆ°ä¸Šä¸‹æ–‡</div>
      <div class="arch-label">é€šè¿‡ grep æŒ‰éœ€æœç´¢</div>
    </div>
  </div>
</div>

<div class="card">
  <div class="card-title">è‡ªåŠ¨æ•´ç†æœºåˆ¶</div>
  <p>å½“ä¼šè¯å†å²è¿‡é•¿æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è§¦å‘æ•´ç†ï¼š</p>
  <ul>
    <li>å°†æ—§å¯¹è¯æ‘˜è¦è¿½åŠ åˆ° HISTORY.mdï¼ˆäº‹ä»¶æ—¥å¿—ï¼‰</li>
    <li>ä»å¯¹è¯ä¸­æå–å…³é”®äº‹å®å†™å…¥ MEMORY.mdï¼ˆé•¿æœŸè®°å¿†ï¼‰</li>
    <li>æ¸…ç†ä¼šè¯å†å²ï¼Œé‡Šæ”¾ä¸Šä¸‹æ–‡çª—å£</li>
  </ul>
  <p>è¿™ç§è®¾è®¡è®© Agent æ—¢èƒ½è®°ä½é‡è¦ä¿¡æ¯ï¼Œåˆä¸ä¼šå› ä¸ºå†å²è¿‡é•¿è€Œè¶…å‡º token é™åˆ¶ã€‚</p>
</div>

<!-- ä¼šè¯ç®¡ç† -->
<h3 id="session">2.9 ä¼šè¯ç®¡ç† (Session)</h3>
<p>SessionManager è´Ÿè´£ç®¡ç†æ‰€æœ‰æ´»è·ƒä¼šè¯ï¼Œæ¯ä¸ª <code>channel:chat_id</code> ç»„åˆå¯¹åº”ä¸€ä¸ªç‹¬ç«‹ä¼šè¯ã€‚</p>
<div class="card">
  <div class="card-title">æ ¸å¿ƒç‰¹æ€§</div>
  <ul>
    <li><strong>éš”ç¦»æ€§</strong>ï¼šä¸åŒç”¨æˆ·ã€ä¸åŒæ¸ é“çš„ä¼šè¯å®Œå…¨éš”ç¦»</li>
    <li><strong>æŒä¹…åŒ–</strong>ï¼šä¼šè¯ä»¥ JSONL æ ¼å¼å­˜å‚¨ï¼Œé‡å¯åè‡ªåŠ¨æ¢å¤</li>
    <li><strong>çª—å£æ§åˆ¶</strong>ï¼š<code>memory_window</code> å‚æ•°æ§åˆ¶å‘é€ç»™ LLM çš„å†å²æ¶ˆæ¯æ•°é‡ï¼ˆé»˜è®¤ 50 æ¡ï¼‰</li>
    <li><strong>è‡ªåŠ¨æ¸…ç†</strong>ï¼šè¶…å‡ºçª—å£çš„æ—§æ¶ˆæ¯ä¼šè¢«æ‘˜è¦åå½’æ¡£</li>
  </ul>
</div>

<!-- å­ä»£ç† -->
<h3 id="subagent">2.10 å­ä»£ç† (Subagent)</h3>
<p>å­ä»£ç†æœºåˆ¶å…è®¸ Agent å°†è€—æ—¶ä»»åŠ¡å§”æ‰˜ç»™åå°å¼‚æ­¥æ‰§è¡Œï¼Œä¸é˜»å¡ä¸»å¯¹è¯ã€‚</p>

<div class="flow">
  <div class="flow-step"><div class="flow-num">1</div><div class="flow-content"><strong>spawn</strong> â€” ä¸» Agent é€šè¿‡ spawn å·¥å…·åˆ›å»ºå­ä»£ç†ï¼ŒæŒ‡å®šä»»åŠ¡æè¿°</div></div>
  <div class="flow-line"></div>
  <div class="flow-step"><div class="flow-num">2</div><div class="flow-content"><strong>å¼‚æ­¥æ‰§è¡Œ</strong> â€” SubagentManager åœ¨åå°å¯åŠ¨ç‹¬ç«‹çš„ AgentLoop å¤„ç†ä»»åŠ¡</div></div>
  <div class="flow-line"></div>
  <div class="flow-step"><div class="flow-num">3</div><div class="flow-content"><strong>ç»“æœå›æŠ¥</strong> â€” å­ä»£ç†å®Œæˆåï¼Œé€šè¿‡ system channel å°†ç»“æœæ³¨å…¥ä¸»ä¼šè¯</div></div>
  <div class="flow-line"></div>
  <div class="flow-step"><div class="flow-num">4</div><div class="flow-content"><strong>ä¸» Agent å¤„ç†</strong> â€” ä¸» Agent æ”¶åˆ°å­ä»£ç†ç»“æœï¼Œç»§ç»­ä¸ç”¨æˆ·å¯¹è¯</div></div>
</div>

<p>å­ä»£ç†æ‹¥æœ‰ä¸ä¸» Agent ç›¸åŒçš„å·¥å…·å’Œèƒ½åŠ›ï¼Œä½†è¿è¡Œåœ¨ç‹¬ç«‹çš„ä¸Šä¸‹æ–‡ä¸­ã€‚é€‚åˆå¤„ç†æ•°æ®æ”¶é›†ã€æ–‡ä»¶ç”Ÿæˆã€éƒ¨ç½²ç­‰è€—æ—¶æ“ä½œã€‚</p>

<!-- å®šæ—¶ä»»åŠ¡ -->
<h3 id="cron">2.11 å®šæ—¶ä»»åŠ¡ (CronService)</h3>
<p>CronService æä¾›ä¸‰ç§è°ƒåº¦æ¨¡å¼ï¼Œè®© Agent èƒ½å¤Ÿåœ¨æŒ‡å®šæ—¶é—´è‡ªåŠ¨æ‰§è¡Œä»»åŠ¡ã€‚</p>

<table>
  <tr><th>æ¨¡å¼</th><th>å‚æ•°</th><th>ç¤ºä¾‹</th><th>ç”¨é€”</th></tr>
  <tr><td><span class="tag tag-blue">at</span></td><td>ISO æ—¶é—´</td><td><code>2026-02-15T09:00:00</code></td><td>ä¸€æ¬¡æ€§å®šæ—¶ä»»åŠ¡</td></tr>
  <tr><td><span class="tag tag-green">every</span></td><td>ç§’æ•°</td><td><code>3600</code>ï¼ˆæ¯å°æ—¶ï¼‰</td><td>å›ºå®šé—´éš”é‡å¤</td></tr>
  <tr><td><span class="tag tag-orange">cron</span></td><td>cron è¡¨è¾¾å¼</td><td><code>0 9 * * *</code>ï¼ˆæ¯å¤©9ç‚¹ï¼‰</td><td>çµæ´»çš„å‘¨æœŸè°ƒåº¦</td></tr>
</table>

<div class="card">
  <div class="card-title">å®ç°ç»†èŠ‚</div>
  <ul>
    <li>CronJob æŒä¹…åŒ–å­˜å‚¨ï¼Œé‡å¯åè‡ªåŠ¨æ¢å¤</li>
    <li>ä½¿ç”¨ <code>croniter</code> åº“è§£æ cron è¡¨è¾¾å¼</li>
    <li>åˆ°æ—¶é—´åè§¦å‘ Agent å¤„ç†ï¼ŒAgent æ”¶åˆ°æé†’æ¶ˆæ¯åæ‰§è¡Œé¢„è®¾æ“ä½œ</li>
    <li>æ”¯æŒ add / list / remove æ“ä½œç®¡ç†ä»»åŠ¡</li>
  </ul>
</div>

<!-- å¿ƒè·³æœåŠ¡ -->
<h3 id="heartbeat">2.12 å¿ƒè·³æœåŠ¡ (Heartbeat)</h3>
<p>HeartbeatService å®šæœŸå”¤é†’ Agentï¼Œæ£€æŸ¥ workspace ä¸­çš„ <code>HEARTBEAT.md</code> æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶å­˜åœ¨ä¸”åŒ…å«ä»»åŠ¡æè¿°ï¼ŒAgent ä¼šè‡ªåŠ¨æ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚è¿™ä¸ºæ— äººå€¼å®ˆçš„è‡ªåŠ¨åŒ–åœºæ™¯æä¾›äº†æ”¯æŒã€‚</p>

<!-- é…ç½®ç³»ç»Ÿ -->
<h2 id="config">é…ç½®ç³»ç»Ÿ</h2>
<p>NanoBot ä½¿ç”¨ <strong>Pydantic</strong> æ¨¡å‹è¿›è¡Œé…ç½®éªŒè¯ï¼Œæ‰€æœ‰é…ç½®é›†ä¸­åœ¨ <code>~/.nanobot/config.json</code>ã€‚</p>

<div class="code-block">
<div class="code-header"><span class="lang">JSON</span><span class="file-path">~/.nanobot/config.json</span><button class="copy-btn" onclick="copyCode(this)">å¤åˆ¶</button></div>
<pre>{
  <span class="str">"providers"</span>: {           <span class="cmt">// LLM æä¾›å•†é…ç½®</span>
    <span class="str">"anthropic"</span>: {
      <span class="str">"api_key"</span>: <span class="str">"sk-..."</span>,
      <span class="str">"api_base"</span>: <span class="str">"https://..."</span>  <span class="cmt">// å¯é€‰ï¼Œè‡ªå®šä¹‰ç«¯ç‚¹</span>
    }
  },
  <span class="str">"agents"</span>: {
    <span class="str">"defaults"</span>: {
      <span class="str">"model"</span>: <span class="str">"anthropic/claude-opus-4-5"</span>,
      <span class="str">"max_tokens"</span>: <span class="num">8192</span>,
      <span class="str">"temperature"</span>: <span class="num">0.7</span>,
      <span class="str">"max_tool_iterations"</span>: <span class="num">20</span>,
      <span class="str">"memory_window"</span>: <span class="num">50</span>
    }
  },
  <span class="str">"channels"</span>: {             <span class="cmt">// æ¸ é“é…ç½®ï¼ˆæŒ‰éœ€å¯ç”¨ï¼‰</span>
    <span class="str">"feishu"</span>: { <span class="str">"enabled"</span>: <span class="num">true</span>, <span class="str">"app_id"</span>: <span class="str">"..."</span>, <span class="str">"app_secret"</span>: <span class="str">"..."</span> },
    <span class="str">"telegram"</span>: { <span class="str">"enabled"</span>: <span class="num">false</span>, <span class="str">"token"</span>: <span class="str">"..."</span> }
  },
  <span class="str">"tools"</span>: {
    <span class="str">"exec"</span>: { <span class="str">"timeout"</span>: <span class="num">60</span> },
    <span class="str">"restrict_to_workspace"</span>: <span class="num">false</span>
  }
}</pre>
</div>

<p>æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–ï¼šä½¿ç”¨ <code>NANOBOT_</code> å‰ç¼€ + <code>__</code> åµŒå¥—åˆ†éš”ç¬¦ã€‚ä¾‹å¦‚ <code>NANOBOT_CHANNELS__FEISHU__ENABLED=true</code>ã€‚</p>

<!-- é¡¹ç›®ç»“æ„ -->
<h2 id="structure">é¡¹ç›®ç»“æ„</h2>
<div class="tree">
<div class="tree-header"><span class="lang">ğŸ“ é¡¹ç›®ç»“æ„</span><span>nanobot v0.1.3</span></div>
<pre><span class="dir">nanobot/</span>
<span class="connector">â”œâ”€â”€</span> <span class="file">__init__.py</span>              <span class="desc"># ç‰ˆæœ¬å·ã€Logo</span>
<span class="connector">â”œâ”€â”€</span> <span class="file">__main__.py</span>              <span class="desc"># å…¥å£ â†’ cli.commands</span>
<span class="connector">â”‚</span>
<span class="connector">â”œâ”€â”€</span> <span class="dir">cli/</span>
<span class="connector">â”‚   â””â”€â”€</span> <span class="file">commands.py</span>          <span class="desc"># Typer CLI + prompt_toolkit REPL</span>
<span class="connector">â”‚</span>
<span class="connector">â”œâ”€â”€</span> <span class="dir">config/</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">loader.py</span>            <span class="desc"># åŠ è½½ config.json</span>
<span class="connector">â”‚   â””â”€â”€</span> <span class="file">schema.py</span>            <span class="desc"># Pydantic é…ç½®æ¨¡å‹</span>
<span class="connector">â”‚</span>
<span class="connector">â”œâ”€â”€</span> <span class="dir">agent/</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">loop.py</span>              <span class="desc"># AgentLoop æ ¸å¿ƒå¼•æ“</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">context.py</span>           <span class="desc"># ContextBuilder ä¸Šä¸‹æ–‡ç»„è£…</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">memory.py</span>            <span class="desc"># MemoryStore è®°å¿†ç®¡ç†</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">skills.py</span>            <span class="desc"># SkillsLoader æŠ€èƒ½åŠ è½½</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">subagent.py</span>          <span class="desc"># SubagentManager å­ä»£ç†</span>
<span class="connector">â”‚   â””â”€â”€</span> <span class="dir">tools/</span>
<span class="connector">â”‚       â”œâ”€â”€</span> <span class="file">base.py</span>          <span class="desc"># å·¥å…·åŸºç±»</span>
<span class="connector">â”‚       â”œâ”€â”€</span> <span class="file">registry.py</span>      <span class="desc"># ToolRegistry æ³¨å†Œè¡¨</span>
<span class="connector">â”‚       â”œâ”€â”€</span> <span class="file">filesystem.py</span>    <span class="desc"># æ–‡ä»¶æ“ä½œå·¥å…·</span>
<span class="connector">â”‚       â”œâ”€â”€</span> <span class="file">shell.py</span>         <span class="desc"># Shell å‘½ä»¤æ‰§è¡Œ</span>
<span class="connector">â”‚       â”œâ”€â”€</span> <span class="file">web.py</span>           <span class="desc"># ç½‘é¡µæœç´¢/æŠ“å–</span>
<span class="connector">â”‚       â”œâ”€â”€</span> <span class="file">message.py</span>       <span class="desc"># æ¶ˆæ¯å‘é€</span>
<span class="connector">â”‚       â”œâ”€â”€</span> <span class="file">spawn.py</span>         <span class="desc"># å­ä»£ç†ç”Ÿæˆ</span>
<span class="connector">â”‚       â””â”€â”€</span> <span class="file">cron.py</span>          <span class="desc"># å®šæ—¶ä»»åŠ¡</span>
<span class="connector">â”‚</span>
<span class="connector">â”œâ”€â”€</span> <span class="dir">channels/</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">base.py</span>              <span class="desc"># BaseChannel æŠ½è±¡åŸºç±»</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">manager.py</span>           <span class="desc"># ChannelManager</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">telegram.py</span>          <span class="desc"># Telegram Bot</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">feishu.py</span>            <span class="desc"># é£ä¹¦ WebSocket</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">dingtalk.py</span>          <span class="desc"># é’‰é’‰ Stream</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">discord.py</span>           <span class="desc"># Discord Gateway</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">slack.py</span>             <span class="desc"># Slack Socket Mode</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">qq.py</span>                <span class="desc"># QQ botpy</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">whatsapp.py</span>          <span class="desc"># WhatsApp Bridge</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">email.py</span>             <span class="desc"># Email IMAP+SMTP</span>
<span class="connector">â”‚   â””â”€â”€</span> <span class="file">mochat.py</span>            <span class="desc"># MoChat Socket.IO</span>
<span class="connector">â”‚</span>
<span class="connector">â”œâ”€â”€</span> <span class="dir">providers/</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">base.py</span>              <span class="desc"># LLMProvider æŠ½è±¡åŸºç±»</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">registry.py</span>          <span class="desc"># Provider æ³¨å†Œè¡¨</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">litellm_provider.py</span>  <span class="desc"># LiteLLM ç»Ÿä¸€æ¥å£</span>
<span class="connector">â”‚   â””â”€â”€</span> <span class="file">transcription.py</span>     <span class="desc"># è¯­éŸ³è½¬æ–‡å­—</span>
<span class="connector">â”‚</span>
<span class="connector">â”œâ”€â”€</span> <span class="dir">bus/</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">events.py</span>            <span class="desc"># æ¶ˆæ¯æ•°æ®ç±»</span>
<span class="connector">â”‚   â””â”€â”€</span> <span class="file">queue.py</span>             <span class="desc"># å¼‚æ­¥æ¶ˆæ¯æ€»çº¿</span>
<span class="connector">â”‚</span>
<span class="connector">â”œâ”€â”€</span> <span class="dir">session/</span>
<span class="connector">â”‚   â””â”€â”€</span> <span class="file">manager.py</span>           <span class="desc"># ä¼šè¯ç®¡ç† + JSONL æŒä¹…åŒ–</span>
<span class="connector">â”‚</span>
<span class="connector">â”œâ”€â”€</span> <span class="dir">cron/</span>
<span class="connector">â”‚   â”œâ”€â”€</span> <span class="file">types.py</span>             <span class="desc"># CronJob æ•°æ®ç±»å‹</span>
<span class="connector">â”‚   â””â”€â”€</span> <span class="file">service.py</span>           <span class="desc"># CronService è°ƒåº¦å™¨</span>
<span class="connector">â”‚</span>
<span class="connector">â”œâ”€â”€</span> <span class="dir">heartbeat/</span>
<span class="connector">â”‚   â””â”€â”€</span> <span class="file">service.py</span>           <span class="desc"># HeartbeatService</span>
<span class="connector">â”‚</span>
<span class="connector">â”œâ”€â”€</span> <span class="dir">utils/</span>
<span class="connector">â”‚   â””â”€â”€</span> <span class="file">helpers.py</span>           <span class="desc"># å·¥å…·å‡½æ•°</span>
<span class="connector">â”‚</span>
<span class="connector">â””â”€â”€</span> <span class="dir">skills/</span>                  <span class="desc"># å†…ç½®æŠ€èƒ½</span>
    <span class="connector">â”œâ”€â”€</span> <span class="dir">cron/</span>    â””â”€â”€ SKILL.md
    <span class="connector">â”œâ”€â”€</span> <span class="dir">github/</span>  â””â”€â”€ SKILL.md
    <span class="connector">â”œâ”€â”€</span> <span class="dir">memory/</span>  â””â”€â”€ SKILL.md
    <span class="connector">â”œâ”€â”€</span> <span class="dir">weather/</span> â””â”€â”€ SKILL.md
    <span class="connector">â””â”€â”€</span> ...</pre>
</div>

<!-- æŠ€æœ¯æ ˆ -->
<h2 id="tech">æŠ€æœ¯æ ˆ</h2>
<table>
  <tr><th>ç±»åˆ«</th><th>æŠ€æœ¯</th><th>ç”¨é€”</th></tr>
  <tr><td>LLM æ¥å£</td><td>LiteLLM</td><td>ç»Ÿä¸€å¤š Provider è°ƒç”¨</td></tr>
  <tr><td>é…ç½®ç®¡ç†</td><td>Pydantic + pydantic-settings</td><td>ç±»å‹å®‰å…¨çš„é…ç½®éªŒè¯</td></tr>
  <tr><td>CLI</td><td>Typer + Rich</td><td>å‘½ä»¤è¡Œç•Œé¢ + ç¾åŒ–è¾“å‡º</td></tr>
  <tr><td>äº¤äº’å¼ç»ˆç«¯</td><td>prompt-toolkit</td><td>REPL äº¤äº’</td></tr>
  <tr><td>HTTP å®¢æˆ·ç«¯</td><td>httpx</td><td>å¼‚æ­¥ HTTP è¯·æ±‚</td></tr>
  <tr><td>æ—¥å¿—</td><td>loguru</td><td>ç»“æ„åŒ–æ—¥å¿—</td></tr>
  <tr><td>å®šæ—¶è°ƒåº¦</td><td>croniter</td><td>cron è¡¨è¾¾å¼è§£æ</td></tr>
  <tr><td>ç½‘é¡µæå–</td><td>readability-lxml</td><td>ç½‘é¡µæ­£æ–‡æå–</td></tr>
  <tr><td>åºåˆ—åŒ–</td><td>msgpack</td><td>é«˜æ•ˆäºŒè¿›åˆ¶åºåˆ—åŒ–</td></tr>
  <tr><td>å¼‚æ­¥æ¡†æ¶</td><td>asyncio</td><td>å…¨å¼‚æ­¥æ¶æ„</td></tr>
</table>

<div class="card">
  <div class="card-title">æ¸ é“ SDK ä¾èµ–</div>
  <p>
    <span class="tag tag-purple">python-telegram-bot</span>
    <span class="tag tag-purple">lark-oapi</span>
    <span class="tag tag-purple">dingtalk-stream</span>
    <span class="tag tag-purple">slack-sdk</span>
    <span class="tag tag-purple">discord.py</span>
    <span class="tag tag-purple">qq-botpy</span>
    <span class="tag tag-purple">python-socketio</span>
    <span class="tag tag-purple">websockets</span>
  </p>
</div>

<footer>
  åŸºäº <a href="https://github.com/HKUDS/nanobot" target="_blank">HKUDS/nanobot</a> é¡¹ç›®æºç åˆ†æ Â· ç‰ˆæœ¬ 0.1.3 Â· MIT License
</footer>

</main>

<script>
function toggleMenu(){
  document.querySelector('.sidebar').classList.toggle('open');
  document.querySelector('.overlay').classList.toggle('show');
}
document.querySelectorAll('.sidebar nav a').forEach(a=>{
  a.addEventListener('click',()=>{
    document.querySelector('.sidebar').classList.remove('open');
    document.querySelector('.overlay').classList.remove('show');
  });
});
function copyCode(btn){
  const pre = btn.closest('.code-block').querySelector('pre');
  const text = pre.innerText;
  navigator.clipboard.writeText(text).then(()=>{
    btn.textContent='å·²å¤åˆ¶';
    btn.classList.add('copied');
    setTimeout(()=>{btn.textContent='å¤åˆ¶';btn.classList.remove('copied');},2000);
  }).catch(()=>{
    const range=document.createRange();
    range.selectNodeContents(pre);
    const sel=window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
    document.execCommand('copy');
    sel.removeAllRanges();
    btn.textContent='å·²å¤åˆ¶';
    btn.classList.add('copied');
    setTimeout(()=>{btn.textContent='å¤åˆ¶';btn.classList.remove('copied');},2000);
  });
}
</script>
</body>
</html>